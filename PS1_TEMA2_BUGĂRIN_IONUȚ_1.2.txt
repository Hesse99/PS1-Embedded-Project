#include <LiquidCrystal.h>
LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

int volatile reading=0;
int ore=14, min=9,sec=58;
int main(){
  
  lcd.begin(16,2);
  OCR1A=62500;
  TCCR1B |= (1 << WGM12) | (1 << CS12);
  TIMSK1 |= (1 << OCIE1A);
  sei();
  ADC_Init();
  while(1){
          }
  
}
void ADC_Init(void)
{
  ADCSRA |= 1 << ADEN;
  ADMUX  |= 1 << REFS0;
  ADCSRA |= 1 << ADIE;
  ADCSRA |= 1 << ADSC;
}

ISR(ADC_vect)
{
  reading=read_adc(0);
  ADCSRA |= 1 << ADSC;
}

ISR(TIMER1_COMPA_vect)
{
 Afisare_Temperatura();
 Afisare_Ceas();
 sec++;
}

void Afisare_Temperatura()
{
  float voltage=0;
  float temperatureCelsius=0; 
  voltage=reading*5.0; 
  voltage/=1023.0;
  temperatureCelsius=(voltage-0.5)*100;
  
  lcd.setCursor(0, 0);
  lcd.print("TEMP : ");
  lcd.print(temperatureCelsius);
  lcd.print(" 'C");
}
void Afisare_Ceas()
{
 
  if(sec==60)
  {
    min++; 
    sec=00;
    lcd.clear();
  }
   
  if(min==60)
  {
    ore++; 
    min=00;}
   if(ore==23)
  {ore=00;}
  lcd.setCursor(0, 1);
  lcd.print("Ora ");
  lcd.print(ore);
  lcd.print(":");
  lcd.print(min);
  lcd.print(":");
  lcd.print(sec);
}
int read_adc(uint8_t channel)
{
ADMUX&=0xF0;//set input AO to A5
ADMUX|=channel;//select chanel AO to A5
ADCSRA|=(1<<ADSC);//start conversion
while(ADCSRA & (1<<ADSC));//wait wile adc conversion are not updated
return ADC;//read and return voltage
}